{% load static %}
<!DOCTYPE html>
<html lang="es">
<head> 
    <meta charset="UTF-8">
    <title>Measurements - EcoEnergy</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
</head>
<body>

<!-- PANEL DE MEDICIONES -->
<div class="container mt-4">

    <!-- Link volver -->
    <div class="mb-3">
        <a href="{% url 'dashboard' %}" class="text-decoration-none">&larr; Volver al dashboard</a>
    </div>

    <!-- Card principal -->
    <div class="card shadow-sm">
        <div class="card-body">
            
            <!-- Encabezado -->
            <h5 class="fw-bold mb-3">MEDICIONES</h5>

            <!-- Tabla de mediciones -->
            <div class="table-responsive">
                <table class="table table-hover align-middle">
                    <thead class="table-light">
                        <tr>
                            <th>Fecha / Hora</th>
                            <th>Valor</th>
                            <th>Dispositivo</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for measurement in measurements %}
                        <tr>
                            <td>{{ measurement.timestamp|date:"d/m/Y H:i" }}</td>
                            <td>{{ measurement.value }}</td>
                            <td>
                                <a href="{% url 'device_detail' measurement.device.id %}">
                                    {{ measurement.device.name }}
                                </a>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="3" class="text-center text-muted">No hay mediciones registradas</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <!-- Paginación -->
            {% if measurements.has_other_pages %}
            <nav aria-label="Page navigation">
                <ul class="pagination justify-content-end">
                    {% if measurements.has_previous %}
                        <li class="page-item">
                            <a class="page-link" href="?page={{ measurements.previous_page_number }}">Anterior</a>
                        </li>
                    {% else %}
                        <li class="page-item disabled"><span class="page-link">Anterior</span></li>
                    {% endif %}

                    {% for num in measurements.paginator.page_range %}
                        {% if measurements.number == num %}
                            <li class="page-item active"><span class="page-link">{{ num }}</span></li>
                        {% else %}
                            <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
                        {% endif %}
                    {% endfor %}

                    {% if measurements.has_next %}
                        <li class="page-item">
                            <a class="page-link" href="?page={{ measurements.next_page_number }}">Siguiente</a>
                        </li>
                    {% else %}
                        <li class="page-item disabled"><span class="page-link">Siguiente</span></li>
                    {% endif %}
                </ul>
            </nav>
            {% endif %}

        </div>
    </div>
</div>

<!-- FOOTER -->
<footer class="mt-4 py-3 bg-light border-top">
    <div class="container text-center">
        <p class="mb-0">© 2025 EcoEnergy | Soporte</p>
    </div>
</footer>

</body>
</html>
